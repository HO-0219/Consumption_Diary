1. ì¹´í…Œê³ ë¦¬ ë¡œë“œ í•˜ëŠ” ë¶€ë¶„ ì—ì„œ ìƒê¸°ëŠ” ì˜¤ë¥˜ 
2. CSV ë°ì´í„° ë¡œë“œ ë° ì €ì¥ ì´ ì•ˆë˜ëŠ” ìƒíƒœ 
3. ì¹´í…Œê³ ë¦¬ê´€ë ¨ CSV íŒŒì¼ ì˜¤ë¥˜ 
4. ì˜¤ëŠ˜ ê¸°ë¡ ì…ë ¥ ë¶€ë¶„ì—ì„œ ë°ì´í„° ì—ëŸ¬ê°€ ìƒê¹€ 



ì¹´í…Œê³ ë¦¬ ì¶”ê°€ ë¶€ë¶„ CSV íŒŒì¼ ì €ì¥ ì˜¤ë¥˜ 
ì˜¤ëŠ˜ ê¸°ë¡ ì…ë ¥ ë¶€ë¶„ Dataerror 


Error loading categories: MissingPluginException(No implementation found for method getApplicationDocumentsDirectory on channel
plugins.flutter.io/path_provider)


DartError: MissingPluginException(No implementation found for method getApplicationDocumentsDirectory on channel plugins.flutter.io/path_provider)



ì¼ë‹¨ ì½”ë“œì—ì„œ ë¬¸ì œê°€ ìˆì–´ ë³´ì´ëŠ” ê±¸ ì±—ì§€í”¼í‹°ê°€ ì°¾ì€ ì½”ë“œ 
##############################################################################################################################
##############################################################################################################################
##############################################################################################################################
##############################################################################################################################
##############################################################################################################################
##############################################################################################################################
Future<void> loadandcreatecategories() async {
  String filePath = await getLocalFilePath('categories.csv');
  final file = File(filePath);

  if (!await file.exists()) {
    List<List<dynamic>> csvData = defaultCategoriyList.map((category) => [category]).toList();
    String csvString = const ListToCsvConverter().convert(csvData);
    await file.writeAsString(csvString, mode: FileMode.write, flush: true);
    debugPrint('ê¸°ë³¸ ì¹´í…Œê³ ë¦¬ ìƒì„± ì™„ë£Œ');
  } 
  await loadCategories(); // ìƒì„± í›„ ì¹´í…Œê³ ë¦¬ ë¡œë“œ
}

// ì¹´í…Œê³ ë¦¬ë¥¼ CSV íŒŒì¼ì—ì„œ ë¡œë“œí•˜ëŠ” í•¨ìˆ˜
Future<void> loadCategories() async {
  try {
    String filePath = await getLocalFilePath('categories.csv');
    final file = File(filePath);

    if (!await file.exists()) {
      categoryList = List.from(defaultCategoriyList);
    } else {
      String csvData = await file.readAsString();
      final csvTable = const CsvToListConverter().convert(csvData);
      setState(() {
        categoryList = csvTable.map((row) => row[0].toString()).toSet().toList();
      });
    }
  } catch (e) {
    debugPrint("Error loading categories: $e");
  }
}

// ì¹´í…Œê³ ë¦¬ë¥¼ CSV íŒŒì¼ì— ì €ì¥í•˜ëŠ” í•¨ìˆ˜ (ì¤‘ë³µ ë°©ì§€ ì¶”ê°€)
Future<void> saveCategoriesToCSV() async {
  try {
    final path = await getLocalFilePath('categories.csv');
    final file = File(path);
    List<String> uniqueCategories = categoryList.toSet().toList(); // ì¤‘ë³µ ì œê±°
    List<List<dynamic>> csvData = uniqueCategories.map((category) => [category]).toList();
    String csvString = const ListToCsvConverter().convert(csvData);
    await file.writeAsString(csvString, mode: FileMode.write, flush: true);
    debugPrint('ì¹´í…Œê³ ë¦¬ê°€ CSVì— ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.');
  } catch (e) {
    debugPrint('CSV ì €ì¥ ì˜¤ë¥˜: $e');
  }
}

// ì†Œë¹„ ê¸°ë¡ì„ CSV íŒŒì¼ì— ì¶”ê°€
void addRecord() {
  final now = TimeOfDay.now();
  final time = '${now.hour.toString().padLeft(2, '0')}:${now.minute.toString().padLeft(2, '0')}';
  final amount = int.tryParse(_amountController.text) ?? 0;
  final description = _descriptionController.text;

  if (selectedCategory.isEmpty || amount == 0 || description.isEmpty) {
    debugPrint('ì…ë ¥ê°’ì´ ë¹„ì–´ìˆì–´ì„œ ì¶”ê°€ê°€ ì•ˆë©ë‹ˆë‹¤');
    return;
  }

  final newRecord = {
    "time": time,
    "category": selectedCategory,
    "amount": amount,
    "description": description,
  };

  setState(() {
    records.add(newRecord);
  });

  addRecordToCSV(newRecord); // CSV íŒŒì¼ì— ê¸°ë¡ ì¶”ê°€
  clearFields(); // í•„ë“œ ì´ˆê¸°í™”
  Navigator.of(context).pop();
}

// CSV íŒŒì¼ì— ìƒˆ ë ˆì½”ë“œ ì¶”ê°€ í•¨ìˆ˜
Future<void> addRecordToCSV(Map<String, dynamic> newRecord) async {
  String filePath = await getLocalFilePath('records.csv');
  final file = File(filePath);

  if (!await file.exists()) await file.create();

  List<List<dynamic>> csvData = [
    [
      DateFormat('yyyy-MM-dd').format(DateTime.now()),
      newRecord["time"],
      newRecord["category"],
      newRecord["amount"],
      newRecord["description"],
    ]
  ];

  String csvString = const ListToCsvConverter().convert(csvData);
  await file.writeAsString(csvString, mode: FileMode.append, flush: true);
}



##############################################################################################################################
##############################################################################################################################
##############################################################################################################################
##############################################################################################################################
##############################################################################################################################
##############################################################################################################################


1. ë°ì´í„° ì´ì–´ì„œ ì €ì¥ë˜ëŠ” ë¬¸ì œ í•´ê²°
ë°ì´í„°ë¥¼ ì €ì¥í•  ë•Œ ê° í•­ëª© ì‚¬ì´ì— ì¤„ë°”ê¿ˆ ë¬¸ìê°€ í¬í•¨ë˜ë„ë¡ íŒŒì¼ì— ì“°ëŠ” ì½”ë“œë¥¼ ìˆ˜ì •í•´ì•¼ í•©ë‹ˆë‹¤.

ì˜ˆë¥¼ ë“¤ì–´, í˜„ì¬ ë°ì´í„°ë¥¼ íŒŒì¼ì— ì €ì¥í•˜ëŠ” ë¶€ë¶„ì´ ì•„ë˜ì™€ ê°™ë‹¤ê³  ê°€ì •í•´ ë³´ê² ìŠµë‹ˆë‹¤.

dart
ì½”ë“œ ë³µì‚¬
String data = "$date,$time,$category,$amount,$note";
file.writeAsString(data, mode: FileMode.append);
ì—¬ê¸°ì„œ dataë¥¼ ì €ì¥í•  ë•Œ ìƒˆ ì¤„ì„ ì¶”ê°€í•´ì•¼ í•©ë‹ˆë‹¤. ë‹¤ìŒê³¼ ê°™ì´ ì½”ë“œë¥¼ ìˆ˜ì •í•´ ë³´ì„¸ìš”.

dart
ì½”ë“œ ë³µì‚¬
String data = "$date,$time,$category,$amount,$note\n";
file.writeAsString(data, mode: FileMode.append);
ì´ì²˜ëŸ¼ ë°ì´í„° ëì— \nì„ ì¶”ê°€í•´ ì£¼ë©´ ê° ë ˆì½”ë“œê°€ ìƒˆ ì¤„ì— ì €ì¥ë˜ë¯€ë¡œ, íŒŒì¼ì„ ë‹¤ì‹œ ì½ì„ ë•Œ ì‰½ê²Œ êµ¬ë¶„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

2. ì¹´í…Œê³ ë¦¬ ì‚­ì œ ë¬¸ì œ í•´ê²°
ì¹´í…Œê³ ë¦¬ë¥¼ ì‚­ì œí–ˆì„ ë•Œ ë³€ê²½ ì‚¬í•­ì´ í™”ë©´ì— ë°˜ì˜ë˜ì§€ ì•ŠëŠ” ë¬¸ì œëŠ” ìƒíƒœ ê´€ë¦¬ë‚˜ ì‚­ì œ í›„ ëª©ë¡ ê°±ì‹ ì´ ëˆ„ë½ë˜ì–´ ë°œìƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì•„ë˜ ë‘ ê°€ì§€ë¥¼ í™•ì¸í•´ ë³´ì„¸ìš”.

ë¦¬ìŠ¤íŠ¸ ìƒíƒœ ì—…ë°ì´íŠ¸: ì‚­ì œê°€ ìˆ˜í–‰ëœ í›„ setState()ë¥¼ í˜¸ì¶œí•˜ì—¬ UIê°€ ê°±ì‹ ë˜ë„ë¡ í•©ë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, ì¹´í…Œê³ ë¦¬ë¥¼ ì‚­ì œí•˜ëŠ” í•¨ìˆ˜ê°€ ë‹¤ìŒê³¼ ê°™ë‹¤ë©´:

dart
ì½”ë“œ ë³µì‚¬
void deleteCategory(String category) {
    categories.remove(category); // ì¹´í…Œê³ ë¦¬ ì‚­ì œ
    setState(() {}); // ìƒíƒœ ê°±ì‹ ì„ ìœ„í•´ setState í˜¸ì¶œ
}
ë°ì´í„° ì €ì¥ì†Œì—ì„œ ì‚­ì œ í™•ì¸: íŒŒì¼ì´ë‚˜ ë°ì´í„°ë² ì´ìŠ¤ì— ì¹´í…Œê³ ë¦¬ê°€ ì œëŒ€ë¡œ ì‚­ì œë˜ëŠ”ì§€ í™•ì¸í•©ë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, ì‚­ì œëœ ì¹´í…Œê³ ë¦¬ë¥¼ ë°˜ì˜í•˜ê¸° ìœ„í•´ íŒŒì¼ì— ì“°ëŠ” ë¶€ë¶„ë„ ë‹¤ì‹œ ì €ì¥í•©ë‹ˆë‹¤.

dart
ì½”ë“œ ë³µì‚¬
void deleteCategory(String category) async {
    categories.remove(category); // ë©”ëª¨ë¦¬ì—ì„œ ì‚­ì œ
    setState(() {});

    // íŒŒì¼ì— ì—…ë°ì´íŠ¸ëœ ì¹´í…Œê³ ë¦¬ ë¦¬ìŠ¤íŠ¸ë¥¼ ë‹¤ì‹œ ì €ì¥
    final file = await getLocalFile();
    file.writeAsString(categories.join('\n')); // ê° ì¹´í…Œê³ ë¦¬ë¥¼ ì¤„ë°”ê¿ˆìœ¼ë¡œ êµ¬ë¶„í•˜ì—¬ ì €ì¥
}
ìœ„ ë°©ë²•ì„ ì ìš©í•˜ë©´ ê° ë¬¸ì œë¥¼ í•´ê²°í•  ê°€ëŠ¥ì„±ì´ í½ë‹ˆë‹¤.











dependencies:
  csv: ^5.0.0
  fl_chart: ^0.40.0

  import 'dart:io';
import 'package:flutter/material.dart';
import 'package:csv/csv.dart';
import 'package:fl_chart/fl_chart.dart';
import 'package:intl/intl.dart';

class MonthPage extends StatefulWidget {
  const MonthPage({super.key});

  @override
  State<MonthPage> createState() => _MonthPageState();
}

class _MonthPageState extends State<MonthPage> {
  List<Map<String, dynamic>> _filteredData = [];

  @override
  void initState() {
    super.initState();
    _loadData();
  }

  // CSV íŒŒì¼ ì½ê¸° ë° í•„í„°ë§
  Future<void> _loadData() async {
    final csvData = await _readCsvFile('assets/your_data.csv'); // íŒŒì¼ ê²½ë¡œë¥¼ ì„¤ì •í•´ ì£¼ì„¸ìš”.
    final filteredData = _filterCurrentMonthData(csvData);
    setState(() {
      _filteredData = filteredData;
    });
  }

  // CSV íŒŒì¼ì„ ì½ëŠ” í•¨ìˆ˜
  Future<List<List<dynamic>>> _readCsvFile(String filePath) async {
    final csvData = await DefaultAssetBundle.of(context).loadString(filePath);
    List<List<dynamic>> csvTable = CsvToListConverter().convert(csvData);
    return csvTable;
  }

  // ì´ë²ˆ ë‹¬ ë°ì´í„° í•„í„°ë§
  List<Map<String, dynamic>> _filterCurrentMonthData(List<List<dynamic>> csvData) {
    DateTime now = DateTime.now();
    DateTime firstDayOfMonth = DateTime(now.year, now.month, 1);
    DateTime lastDayOfMonth = DateTime(now.year, now.month + 1, 1).subtract(Duration(days: 1));
    DateFormat dateFormat = DateFormat('yyyy-MM-dd');

    List<Map<String, dynamic>> filteredData = [];

    for (var row in csvData.skip(1)) { // ì²« ë²ˆì§¸ í–‰ì€ í—¤ë”ë¼ ê°€ì •í•˜ê³  ê±´ë„ˆëœ€
      DateTime date;
      try {
        date = dateFormat.parse(row[0]);
      } catch (e) {
        continue; // ë‚ ì§œ í˜•ì‹ì´ ì˜ëª»ëœ ê²½ìš° ê±´ë„ˆëœ€
      }

      if (date.isAfter(firstDayOfMonth.subtract(Duration(days: 1))) && date.isBefore(lastDayOfMonth.add(Duration(days: 1)))) {
        filteredData.add({
          "date": date,
          "time": row[1],
          "category": row[2],
          "amount": double.parse(row[3].toString()),
          "description": row[4],
        });
      }
    }
    return filteredData;
  }

  // ì¹´í…Œê³ ë¦¬ë³„ ê¸ˆì•¡ í•©ê³„ ê³„ì‚°
  Map<String, double> _calculateCategoryAmounts() {
    Map<String, double> categoryAmounts = {};

    for (var entry in _filteredData) {
      String category = entry["category"];
      double amount = entry["amount"];
      if (categoryAmounts.containsKey(category)) {
        categoryAmounts[category] = categoryAmounts[category]! + amount;
      } else {
        categoryAmounts[category] = amount;
      }
    }

    return categoryAmounts;
  }

  // ì›í˜• ê·¸ë˜í”„ ë°ì´í„° ìƒì„±
  List<PieChartSectionData> _generatePieChartSections(Map<String, double> categoryAmounts) {
    return categoryAmounts.entries.map((entry) {
      return PieChartSectionData(
        title: entry.key,
        value: entry.value,
        color: Colors.primaries[categoryAmounts.keys.toList().indexOf(entry.key) % Colors.primaries.length],
        radius: 50,
      );
    }).toList();
  }

  // ë§‰ëŒ€ ê·¸ë˜í”„ ë°ì´í„° ìƒì„±
  List<BarChartGroupData> _generateBarChartData(Map<String, double> categoryAmounts) {
    return categoryAmounts.entries.map((entry) {
      int index = categoryAmounts.keys.toList().indexOf(entry.key);
      return BarChartGroupData(
        x: index,
        barRods: [
          BarChartRodData(
            toY: entry.value,
            color: Colors.blue,
            width: 15,
          ),
        ],
        showingTooltipIndicators: [0],
      );
    }).toList();
  }

  @override
  Widget build(BuildContext context) {
    final categoryAmounts = _calculateCategoryAmounts();

    return Scaffold(
      appBar: AppBar(title: const Text('Month Data')),
      body: SingleChildScrollView(
        child: Column(
          children: [
            const SizedBox(height: 20),
            const Text(
              'ì´ë²ˆ ë‹¬ ì¹´í…Œê³ ë¦¬ë³„ ê¸ˆì•¡ ì›í˜• ê·¸ë˜í”„',
              style: TextStyle(fontSize: 18, fontWeight: FontWeight.bold),
            ),
            const SizedBox(height: 10),
            // ì›í˜• ê·¸ë˜í”„
            AspectRatio(
              aspectRatio: 1.3,
              child: PieChart(
                PieChartData(
                  sections: _generatePieChartSections(categoryAmounts),
                  sectionsSpace: 2,
                  centerSpaceRadius: 40,
                ),
              ),
            ),
            const SizedBox(height: 30),
            const Text(
              'ì´ë²ˆ ë‹¬ ì¹´í…Œê³ ë¦¬ë³„ ê¸ˆì•¡ ë§‰ëŒ€ ê·¸ë˜í”„',
              style: TextStyle(fontSize: 18, fontWeight: FontWeight.bold),
            ),
            const SizedBox(height: 10),
            // ë§‰ëŒ€ ê·¸ë˜í”„
            AspectRatio(
              aspectRatio: 1.5,
              child: BarChart(
                BarChartData(
                  alignment: BarChartAlignment.spaceAround,
                  barGroups: _generateBarChartData(categoryAmounts),
                  titlesData: FlTitlesData(
                    leftTitles: AxisTitles(
                      sideTitles: SideTitles(showTitles: true),
                    ),
                    bottomTitles: AxisTitles(
                      sideTitles: SideTitles(
                        showTitles: true,
                        getTitlesWidget: (double value, TitleMeta meta) {
                          String category = categoryAmounts.keys.toList()[value.toInt()];
                          return Text(category);
                        },
                      ),
                    ),
                  ),
                  borderData: FlBorderData(show: false),
                ),
              ),
            ),
          ],
        ),
      ),
    );
  }
}





############################################################################################################################################
############################################################################################################################################
############################################################################################################################################
############################################################################################################################################
############################################################################################################################################




Failed to open cache file: '/Users/gimhogyeong/Desktop/flutter/my_flutter_app_001/build/macos/SDKStatCaches.noindex/macosx15.1-24B75-26c8390a7c93c703a57fb2538426748e.sdkstatcache': Permission denied
Command ClangStatCache failed with a nonzero exit code
** BUILD FAILED **


2024-11-19 17:01:35.120 my_flutter_app_001[17809:54776] TISFileInterrogator updateSystemInputSources false but old data invalid: currentCacheHeaderPtr nonNULL? 0, ->cacheFormatVersion 0, ->magicCookie 00000000, inputSourceTableCountSys 0
Keyboard Layouts: duplicate keyboard layout identifier -17410.
Keyboard Layouts: keyboard layout identifier -17410 has been replaced with -28673.
Keyboard Layouts: duplicate keyboard layout identifier -30769.
Keyboard Layouts: keyboard layout identifier -30769 has been replaced with -28674.
Keyboard Layouts: duplicate keyboard layout identifier -14934.
Keyboard Layouts: keyboard layout identifier -14934 has been replaced with -28675.
Syncing files to device macOS...                                    81ms

Flutter run key commands.
r Hot reload. ğŸ”¥ğŸ”¥ğŸ”¥
R Hot restart.
h List all available interactive commands.
d Detach (terminate "flutter run" but leave application running).
c Clear the screen
q Quit (terminate the application on the device).

A Dart VM Service on macOS is available at: http://127.0.0.1:50665/jkMBqQxqAF8=/
flutter: ì˜¤ëŠ˜ì€ 1ì¼ì´ ì•„ë‹ˆë¯€ë¡œ ë°±ì—…í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.
The Flutter DevTools debugger and profiler on macOS is available at: http://127.0.0.1:9101?uri=http://127.0.0.1:50665/jkMBqQxqAF8=/
[ERROR:flutter/runtime/dart_vm_initializer.cc(41)] Unhandled Exception: type 'List<String>' is not a subtype of type 'String' in type cast
#0      _TodayPageState.loadandcreatecategories (package:my_flutter_app_001/pages/TodayPage.dart:277:43)
<asynchronous suspension>

flutter: csv íŒŒì¼ì´ ìˆìŒ
2024-11-19 17:01:50.452 my_flutter_app_001[17809:54776] WARNING: Secure coding is automatically enabled for restorable state! However, not on all supported macOS versions of this application. Opt-in to secure coding explicitly by implementing NSApplicationDelegate.applicationSupportsSecureRestorableState:.
